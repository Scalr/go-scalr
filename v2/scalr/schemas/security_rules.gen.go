// Code generated by scalr-gen. DO NOT EDIT.

package schemas

import (
	"encoding/json"

	"github.com/scalr/go-scalr/v2/scalr/value"
)

// Response version - used when unmarshalling from API responses
// Account security rules.
type SecurityRules struct {
	ID         string                  `json:"id"`
	Type       string                  `json:"type"`
	Attributes SecurityRulesAttributes `json:"attributes"`
}

// GetID returns the resource ID (implements client.ResourceLike)
func (r SecurityRules) GetID() string {
	return r.ID
}

// GetResourceType returns the JSON:API resource type (implements client.ResourceLike)
func (r SecurityRules) GetResourceType() string {
	if r.Type != "" {
		return r.Type
	}
	return "security-rules"
}

// SecurityRulesAttributes holds the attributes for SecurityRules (response)
type SecurityRulesAttributes struct {
	// The maximum lifetime of a personal user access token in minutes.
	MaxPersonalTokenLifetime *int `json:"max-personal-token-lifetime"`
	// The maximum lifetime of a service account access token in minutes.
	MaxServiceAccountTokenLifetime *int `json:"max-service-account-token-lifetime"`
	// Whether to require owners for service accounts.
	RequireOwnersForServiceAccounts bool `json:"require-owners-for-service-accounts"`
}

// Request version - used when marshalling for API requests
// Account security rules. (for requests)
type SecurityRulesRequest struct {
	ID         string                         `json:"id,omitempty"`
	Type       string                         `json:"type,omitempty"`
	Attributes SecurityRulesAttributesRequest `json:"attributes,omitempty"`
}

// MarshalJSON automatically sets the Type field during marshalling
func (r SecurityRulesRequest) MarshalJSON() ([]byte, error) {
	type Alias SecurityRulesRequest
	if r.Type == "" {
		r.Type = "security-rules"
	}
	return json.Marshal((Alias)(r))
}

// GetID returns the resource ID (implements client.ResourceLike)
func (r SecurityRulesRequest) GetID() string {
	return r.ID
}

// GetResourceType returns the JSON:API resource type (implements client.ResourceLike)
func (r SecurityRulesRequest) GetResourceType() string {
	return "security-rules"
}

// SecurityRulesAttributesRequest holds the attributes for SecurityRules (request)
type SecurityRulesAttributesRequest struct {
	// The maximum lifetime of a personal user access token in minutes.
	MaxPersonalTokenLifetime *value.Value[int] `json:"max-personal-token-lifetime,omitempty"`
	// The maximum lifetime of a service account access token in minutes.
	MaxServiceAccountTokenLifetime *value.Value[int] `json:"max-service-account-token-lifetime,omitempty"`
	// Whether to require owners for service accounts.
	RequireOwnersForServiceAccounts *value.Value[bool] `json:"require-owners-for-service-accounts,omitempty"`
}
