// Code generated by scalr-gen. DO NOT EDIT.

package schemas

import (
	"encoding/json"

	"github.com/scalr/go-scalr/v2/scalr/value"
)

// SamlIntegrationVerificationStatus represents the type for SamlIntegrationVerificationStatus
// Represents the verification status with the IdP SAML provider)
type SamlIntegrationVerificationStatus string

// SamlIntegrationVerificationStatus constants
const (
	SamlIntegrationVerificationStatusPending SamlIntegrationVerificationStatus = "pending"
	SamlIntegrationVerificationStatusSuccess SamlIntegrationVerificationStatus = "success"
	SamlIntegrationVerificationStatusRunning SamlIntegrationVerificationStatus = "running"
)

// SamlIntegrationStatus represents the type for SamlIntegrationStatus
// Status of SAML integration.
type SamlIntegrationStatus string

// SamlIntegrationStatus constants
const (
	SamlIntegrationStatusActive   SamlIntegrationStatus = "active"
	SamlIntegrationStatusDisabled SamlIntegrationStatus = "disabled"
	SamlIntegrationStatusFailed   SamlIntegrationStatus = "failed"
)

// SamlIntegrationSecurityRequestedAuthnContextComparison represents the type for SamlIntegrationSecurityRequestedAuthnContextComparison
// Allows the authn comparison parameter to be set.
type SamlIntegrationSecurityRequestedAuthnContextComparison string

// SamlIntegrationSecurityRequestedAuthnContextComparison constants
const (
	SamlIntegrationSecurityRequestedAuthnContextComparisonExact   SamlIntegrationSecurityRequestedAuthnContextComparison = "exact"
	SamlIntegrationSecurityRequestedAuthnContextComparisonMinimum SamlIntegrationSecurityRequestedAuthnContextComparison = "minimum"
	SamlIntegrationSecurityRequestedAuthnContextComparisonBetter  SamlIntegrationSecurityRequestedAuthnContextComparison = "better"
	SamlIntegrationSecurityRequestedAuthnContextComparisonMaximum SamlIntegrationSecurityRequestedAuthnContextComparison = "maximum"
)

// SamlIntegrationSecurityDigestAlgorithm represents the type for SamlIntegrationSecurityDigestAlgorithm
// Algorithm that Scalr will use on digest process.
type SamlIntegrationSecurityDigestAlgorithm string

// SamlIntegrationSecurityDigestAlgorithm constants
const (
	SamlIntegrationSecurityDigestAlgorithmHttpwwwW3Org200104xmlencsha256      SamlIntegrationSecurityDigestAlgorithm = "http://www.w3.org/2001/04/xmlenc#sha256"
	SamlIntegrationSecurityDigestAlgorithmHttpwwwW3Org200104xmldsigMoresha384 SamlIntegrationSecurityDigestAlgorithm = "http://www.w3.org/2001/04/xmldsig-more#sha384"
	SamlIntegrationSecurityDigestAlgorithmHttpwwwW3Org200104xmlencsha512      SamlIntegrationSecurityDigestAlgorithm = "http://www.w3.org/2001/04/xmlenc#sha512"
)

// SamlIntegrationSecuritySignatureAlgorithm represents the type for SamlIntegrationSecuritySignatureAlgorithm
// Algorithm that Scalr will use on signing process.
type SamlIntegrationSecuritySignatureAlgorithm string

// SamlIntegrationSecuritySignatureAlgorithm constants
const (
	SamlIntegrationSecuritySignatureAlgorithmHttpwwwW3Org200104xmldsigMorersaSha256 SamlIntegrationSecuritySignatureAlgorithm = "http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"
	SamlIntegrationSecuritySignatureAlgorithmHttpwwwW3Org200104xmldsigMorersaSha384 SamlIntegrationSecuritySignatureAlgorithm = "http://www.w3.org/2001/04/xmldsig-more#rsa-sha384"
	SamlIntegrationSecuritySignatureAlgorithmHttpwwwW3Org200104xmldsigMorersaSha512 SamlIntegrationSecuritySignatureAlgorithm = "http://www.w3.org/2001/04/xmldsig-more#rsa-sha512"
)

// Response version - used when unmarshalling from API responses

type SamlIntegration struct {
	ID            string                       `json:"id"`
	Type          string                       `json:"type"`
	Attributes    SamlIntegrationAttributes    `json:"attributes"`
	Relationships SamlIntegrationRelationships `json:"relationships"`
}

// GetID returns the resource ID (implements client.ResourceLike)
func (r SamlIntegration) GetID() string {
	return r.ID
}

// GetResourceType returns the JSON:API resource type (implements client.ResourceLike)
func (r SamlIntegration) GetResourceType() string {
	if r.Type != "" {
		return r.Type
	}
	return "saml-integration"
}

// SamlIntegrationAttributes holds the attributes for SamlIntegration (response)
type SamlIntegrationAttributes struct {
	// If enabled, user will be redirected to IdP's login page.
	AutoRedirect *bool `json:"auto-redirect"`
	// Base URL to construct SAML endpoints from. It needs to be a URL with the protocol, server, port and context path.
	BaseUrl *string `json:"base-url"`
	// Enables debug mode.
	Debug bool `json:"debug"`
	// A message from an IdP that indicates a nature of the problem
	ErrorMessage *string `json:"error-message"`
	// Instead of using the whole x509cert you can use a fingerprint in order to validate the SAMLResponse, but we don't recommend to use this method on production since is exploitable by collision attack.
	IdpCertFingerprint *string `json:"idp-cert-fingerprint"`
	// IDP cert fingerprint algorithm
	IdpCertFingerprintAlgorithm string `json:"idp-cert-fingerprint-algorithm"`
	// Identifier of the IdP entity (must be a URI).
	IdpEntityId string `json:"idp-entity-id"`
	// SAML protocol binding to be used when returning the response message (urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect).
	IdpSingleLogoutServiceBinding *string `json:"idp-single-logout-service-binding"`
	// URL location of IdP where SLO Response will be sent.
	IdpSingleLogoutServiceResponseUrl *string `json:"idp-single-logout-service-response-url"`
	// URL target of IdP where Scalr will send the SLO Request.
	IdpSingleLogoutServiceUrl *string `json:"idp-single-logout-service-url"`
	// SAML protocol binding to be used when returning the response message (urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect).
	IdpSingleSignOnServiceBinding *string `json:"idp-single-sign-on-service-binding"`
	// URL target of IdP where Scalr will send the Authentication Request Message.
	IdpSingleSignOnServiceUrl string `json:"idp-single-sign-on-service-url"`
	// Public x509 certificate of the IdP.
	IdpX509Cert *string `json:"idp-x509cert"`
	// IDP x509cert multi encryption
	IdpX509CertMultiEncryption *string `json:"idp-x509cert-multi-encryption"`
	// In some scenarios IdP uses different certificates for signing/encryption, or is under key rollover phase and more than one certificate is published on IdP metadata. (when used, 'IdP x509cert' and 'IdP Cert Fingerprint' values are ignored)
	IdpX509CertMultiSigning *string `json:"idp-x509cert-multi-signing"`
	// Whether this SAML IdP is in use.
	IsUsed bool `json:"is-used"`
	// Account type.
	MappingAzureAadAccountType *string `json:"mapping-azure-aad-account-type"`
	// Client ID.
	MappingAzureAadClientId *string `json:"mapping-azure-aad-client-id"`
	// Use Azure Active Directory.
	MappingAzureAadEnabled bool `json:"mapping-azure-aad-enabled"`
	// Secret key.
	MappingAzureAadSecretKey *string `json:"mapping-azure-aad-secret-key"`
	// Tenant ID.
	MappingAzureAadTenantId *string `json:"mapping-azure-aad-tenant-id"`
	// Email attribute, in case usernames and emails are different.
	MappingEmail *string `json:"mapping-email"`
	// Display name attribute.
	MappingFullname *string `json:"mapping-fullname"`
	// The name of the Groups attribute to use in SAML Assertion.
	MappingGroups *string `json:"mapping-groups"`
	// Groups separator
	MappingSeparator *string `json:"mapping-separator"`
	// Name of SAML integration
	Name string `json:"name"`
	// If true, it will not raise an error when the Statement Element contains attribute elements with name duplicated.
	SecurityAllowRepeatAttributeName bool `json:"security-allow-repeat-attribute-name"`
	// Indicates whether the <samlp:AuthnRequest> messages sent by Scalr will be signed.
	SecurityAuthnRequestsSigned bool `json:"security-authn-requests-signed"`
	// Algorithm that Scalr will use on digest process.
	SecurityDigestAlgorithm *SamlIntegrationSecurityDigestAlgorithm `json:"security-digest-algorithm"`
	// Indicates whether the <samlp:logoutRequest> messages sent by Scalr will be signed.
	SecurityLogoutRequestSigned bool `json:"security-logout-request-signed"`
	// Indicates whether the <samlp:logoutResponse> messages sent by Scalr will be signed.
	SecurityLogoutResponseSigned bool `json:"security-logout-response-signed"`
	// Indicates that the nameID of the <samlp:logoutRequest> sent by Scalr will be encrypted.
	SecurityNameIdEncrypted bool `json:"security-name-id-encrypted"`
	// Leave empty and no AuthContext will be sent in the AuthNRequest,Set an array with the possible auth context values: ["urn:oasis:names:tc:SAML:2.0:ac:classes:Password", "urn:oasis:names:tc:SAML:2.0:ac:classes:X509"]
	SecurityRequestedAuthnContext string `json:"security-requested-authn-context"`
	// Allows the authn comparison parameter to be set.
	SecurityRequestedAuthnContextComparison SamlIntegrationSecurityRequestedAuthnContextComparison `json:"security-requested-authn-context-comparison"`
	// Sign the Metadata. If enabled SP certificate must be provided.
	SecuritySignMetadata *bool `json:"security-sign-metadata"`
	// Algorithm that Scalr will use on signing process.
	SecuritySignatureAlgorithm SamlIntegrationSecuritySignatureAlgorithm `json:"security-signature-algorithm"`
	// Indicates a requirement for the <saml:Assertion> elements received by Scalr to be encrypted.
	SecurityWantAssertionsEncrypted bool `json:"security-want-assertions-encrypted"`
	// Indicates a requirement for the <saml:Assertion> elements received by Scalr to be signed.
	SecurityWantAssertionsSigned bool `json:"security-want-assertions-signed"`
	// Indicates a requirement for the <samlp:Response>, <samlp:LogoutRequest> and <samlp:LogoutResponse> elements received by Scalr to be signed.
	SecurityWantMessagesSigned bool `json:"security-want-messages-signed"`
	// Indicates a requirement for the NameID element on the SAMLResponse received by this SP to be present.
	SecurityWantNameId bool `json:"security-want-name-id"`
	// Indicates a requirement for the NameID received by Scalr to be encrypted.
	SecurityWantNameIdEncrypted bool `json:"security-want-name-id-encrypted"`
	// SAML protocol binding to be used when returning the response message. It supports HTTP-POST binding only.
	SpAssertionConsumerServiceBinding string `json:"sp-assertion-consumer-service-binding"`
	SpDefaultEntityId                 string `json:"sp-default-entity-id"`
	// Service provider entity identifier
	SpEntityId string `json:"sp-entity-id"`
	// SP name id format
	SpNameIdFormat string `json:"sp-name-id-format"`
	// SP private key
	SpPrivateKey *string `json:"sp-private-key"`
	// SP single logout service binding
	SpSingleLogoutServiceBinding string `json:"sp-single-logout-service-binding"`
	// SP x509cert
	SpX509Cert *string `json:"sp-x509cert"`
	// SP x509cert new
	SpX509CertNew *string `json:"sp-x509cert-new"`
	// Status of SAML integration.
	Status SamlIntegrationStatus `json:"status"`
	// If enabled, Scalr will reject unsigned or unencrypted messages when expects them to be signed or encrypted.
	Strict              bool `json:"strict"`
	UseIdentifierInUrls bool `json:"use-identifier-in-urls"`
	// Represents the verification status with the IdP SAML provider)
	VerificationStatus SamlIntegrationVerificationStatus `json:"verification-status"`
}

// SamlIntegrationRelationships holds the relationships for SamlIntegration (response)
type SamlIntegrationRelationships struct {
	// The account this SAML integration belongs to.
	Account *Account `json:"account"`
}

// UnmarshalJSON implements custom unmarshalling for relationships
func (r *SamlIntegrationRelationships) UnmarshalJSON(data []byte) error {
	// Parse into temporary structure that matches JSON:API format
	var temp map[string]json.RawMessage
	if err := json.Unmarshal(data, &temp); err != nil {
		return err
	}

	if raw, ok := temp["account"]; ok {
		// To-one relationship
		var rel struct {
			Data *struct {
				ID   string `json:"id"`
				Type string `json:"type"`
			} `json:"data"`
		}
		if err := json.Unmarshal(raw, &rel); err != nil {
			return err
		}
		if rel.Data != nil {
			r.Account = &Account{
				ID:   rel.Data.ID,
				Type: rel.Data.Type,
			}
		}
	}
	return nil
}

// PopulateIncludes merges included resources into the relationships
func (r *SamlIntegrationRelationships) PopulateIncludes(included []map[string]interface{}) {
	if r == nil || len(included) == 0 {
		return
	}

	// Build a map of included resources by type+id for fast lookup
	includedMap := make(map[string]map[string]interface{})
	for _, inc := range included {
		if id, ok := inc["id"].(string); ok {
			if typ, ok := inc["type"].(string); ok {
				key := typ + ":" + id
				includedMap[key] = inc
			}
		}
	}

	// Populate to-one relationship: Account
	if r.Account != nil && r.Account.ID != "" {
		key := r.Account.Type + ":" + r.Account.ID
		if fullResource, ok := includedMap[key]; ok {
			// Unmarshal the full resource
			data, _ := json.Marshal(fullResource)
			var full Account
			if err := json.Unmarshal(data, &full); err == nil {
				r.Account = &full
			}
		}
	}
}

// Request version - used when marshalling for API requests

type SamlIntegrationRequest struct {
	ID            string                              `json:"id,omitempty"`
	Type          string                              `json:"type,omitempty"`
	Attributes    SamlIntegrationAttributesRequest    `json:"attributes,omitempty"`
	Relationships SamlIntegrationRelationshipsRequest `json:"relationships,omitempty"`
}

// MarshalJSON automatically sets the Type field during marshalling
func (r SamlIntegrationRequest) MarshalJSON() ([]byte, error) {
	type Alias SamlIntegrationRequest
	if r.Type == "" {
		r.Type = "saml-integration"
	}
	return json.Marshal((Alias)(r))
}

// GetID returns the resource ID (implements client.ResourceLike)
func (r SamlIntegrationRequest) GetID() string {
	return r.ID
}

// GetResourceType returns the JSON:API resource type (implements client.ResourceLike)
func (r SamlIntegrationRequest) GetResourceType() string {
	return "saml-integration"
}

// SamlIntegrationAttributesRequest holds the attributes for SamlIntegration (request)
type SamlIntegrationAttributesRequest struct {
	// If enabled, user will be redirected to IdP's login page.
	AutoRedirect *value.Value[bool] `json:"auto-redirect,omitempty"`
	// Base URL to construct SAML endpoints from. It needs to be a URL with the protocol, server, port and context path.
	BaseUrl *value.Value[string] `json:"base-url,omitempty"`
	// Enables debug mode.
	Debug *value.Value[bool] `json:"debug,omitempty"`
	// Instead of using the whole x509cert you can use a fingerprint in order to validate the SAMLResponse, but we don't recommend to use this method on production since is exploitable by collision attack.
	IdpCertFingerprint *value.Value[string] `json:"idp-cert-fingerprint,omitempty"`
	// IDP cert fingerprint algorithm
	IdpCertFingerprintAlgorithm *value.Value[string] `json:"idp-cert-fingerprint-algorithm,omitempty"`
	// Identifier of the IdP entity (must be a URI).
	IdpEntityId *value.Value[string] `json:"idp-entity-id,omitempty"`
	// SAML protocol binding to be used when returning the response message (urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect).
	IdpSingleLogoutServiceBinding *value.Value[string] `json:"idp-single-logout-service-binding,omitempty"`
	// URL location of IdP where SLO Response will be sent.
	IdpSingleLogoutServiceResponseUrl *value.Value[string] `json:"idp-single-logout-service-response-url,omitempty"`
	// URL target of IdP where Scalr will send the SLO Request.
	IdpSingleLogoutServiceUrl *value.Value[string] `json:"idp-single-logout-service-url,omitempty"`
	// SAML protocol binding to be used when returning the response message (urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect).
	IdpSingleSignOnServiceBinding *value.Value[string] `json:"idp-single-sign-on-service-binding,omitempty"`
	// URL target of IdP where Scalr will send the Authentication Request Message.
	IdpSingleSignOnServiceUrl *value.Value[string] `json:"idp-single-sign-on-service-url,omitempty"`
	// Public x509 certificate of the IdP.
	IdpX509Cert *value.Value[string] `json:"idp-x509cert,omitempty"`
	// IDP x509cert multi encryption
	IdpX509CertMultiEncryption *value.Value[string] `json:"idp-x509cert-multi-encryption,omitempty"`
	// In some scenarios IdP uses different certificates for signing/encryption, or is under key rollover phase and more than one certificate is published on IdP metadata. (when used, 'IdP x509cert' and 'IdP Cert Fingerprint' values are ignored)
	IdpX509CertMultiSigning *value.Value[string] `json:"idp-x509cert-multi-signing,omitempty"`
	// Account type.
	MappingAzureAadAccountType *value.Value[string] `json:"mapping-azure-aad-account-type,omitempty"`
	// Client ID.
	MappingAzureAadClientId *value.Value[string] `json:"mapping-azure-aad-client-id,omitempty"`
	// Use Azure Active Directory.
	MappingAzureAadEnabled *value.Value[bool] `json:"mapping-azure-aad-enabled,omitempty"`
	// Secret key.
	MappingAzureAadSecretKey *value.Value[string] `json:"mapping-azure-aad-secret-key,omitempty"`
	// Tenant ID.
	MappingAzureAadTenantId *value.Value[string] `json:"mapping-azure-aad-tenant-id,omitempty"`
	// Email attribute, in case usernames and emails are different.
	MappingEmail *value.Value[string] `json:"mapping-email,omitempty"`
	// Display name attribute.
	MappingFullname *value.Value[string] `json:"mapping-fullname,omitempty"`
	// The name of the Groups attribute to use in SAML Assertion.
	MappingGroups *value.Value[string] `json:"mapping-groups,omitempty"`
	// Groups separator
	MappingSeparator *value.Value[string] `json:"mapping-separator,omitempty"`
	// Name of SAML integration
	Name *value.Value[string] `json:"name,omitempty"`
	// If true, it will not raise an error when the Statement Element contains attribute elements with name duplicated.
	SecurityAllowRepeatAttributeName *value.Value[bool] `json:"security-allow-repeat-attribute-name,omitempty"`
	// Indicates whether the <samlp:AuthnRequest> messages sent by Scalr will be signed.
	SecurityAuthnRequestsSigned *value.Value[bool] `json:"security-authn-requests-signed,omitempty"`
	// Algorithm that Scalr will use on digest process.
	SecurityDigestAlgorithm *value.Value[SamlIntegrationSecurityDigestAlgorithm] `json:"security-digest-algorithm,omitempty"`
	// Indicates whether the <samlp:logoutRequest> messages sent by Scalr will be signed.
	SecurityLogoutRequestSigned *value.Value[bool] `json:"security-logout-request-signed,omitempty"`
	// Indicates whether the <samlp:logoutResponse> messages sent by Scalr will be signed.
	SecurityLogoutResponseSigned *value.Value[bool] `json:"security-logout-response-signed,omitempty"`
	// Indicates that the nameID of the <samlp:logoutRequest> sent by Scalr will be encrypted.
	SecurityNameIdEncrypted *value.Value[bool] `json:"security-name-id-encrypted,omitempty"`
	// Leave empty and no AuthContext will be sent in the AuthNRequest,Set an array with the possible auth context values: ["urn:oasis:names:tc:SAML:2.0:ac:classes:Password", "urn:oasis:names:tc:SAML:2.0:ac:classes:X509"]
	SecurityRequestedAuthnContext *value.Value[string] `json:"security-requested-authn-context,omitempty"`
	// Allows the authn comparison parameter to be set.
	SecurityRequestedAuthnContextComparison *value.Value[SamlIntegrationSecurityRequestedAuthnContextComparison] `json:"security-requested-authn-context-comparison,omitempty"`
	// Sign the Metadata. If enabled SP certificate must be provided.
	SecuritySignMetadata *value.Value[bool] `json:"security-sign-metadata,omitempty"`
	// Algorithm that Scalr will use on signing process.
	SecuritySignatureAlgorithm *value.Value[SamlIntegrationSecuritySignatureAlgorithm] `json:"security-signature-algorithm,omitempty"`
	// Indicates a requirement for the <saml:Assertion> elements received by Scalr to be encrypted.
	SecurityWantAssertionsEncrypted *value.Value[bool] `json:"security-want-assertions-encrypted,omitempty"`
	// Indicates a requirement for the <saml:Assertion> elements received by Scalr to be signed.
	SecurityWantAssertionsSigned *value.Value[bool] `json:"security-want-assertions-signed,omitempty"`
	// Indicates a requirement for the <samlp:Response>, <samlp:LogoutRequest> and <samlp:LogoutResponse> elements received by Scalr to be signed.
	SecurityWantMessagesSigned *value.Value[bool] `json:"security-want-messages-signed,omitempty"`
	// Indicates a requirement for the NameID element on the SAMLResponse received by this SP to be present.
	SecurityWantNameId *value.Value[bool] `json:"security-want-name-id,omitempty"`
	// Indicates a requirement for the NameID received by Scalr to be encrypted.
	SecurityWantNameIdEncrypted *value.Value[bool] `json:"security-want-name-id-encrypted,omitempty"`
	// SAML protocol binding to be used when returning the response message. It supports HTTP-POST binding only.
	SpAssertionConsumerServiceBinding *value.Value[string] `json:"sp-assertion-consumer-service-binding,omitempty"`
	// Service provider entity identifier
	SpEntityId *value.Value[string] `json:"sp-entity-id,omitempty"`
	// SP name id format
	SpNameIdFormat *value.Value[string] `json:"sp-name-id-format,omitempty"`
	// SP private key
	SpPrivateKey *value.Value[string] `json:"sp-private-key,omitempty"`
	// SP single logout service binding
	SpSingleLogoutServiceBinding *value.Value[string] `json:"sp-single-logout-service-binding,omitempty"`
	// SP x509cert
	SpX509Cert *value.Value[string] `json:"sp-x509cert,omitempty"`
	// SP x509cert new
	SpX509CertNew *value.Value[string] `json:"sp-x509cert-new,omitempty"`
	// Status of SAML integration.
	Status *value.Value[SamlIntegrationStatus] `json:"status,omitempty"`
	// If enabled, Scalr will reject unsigned or unencrypted messages when expects them to be signed or encrypted.
	Strict              *value.Value[bool] `json:"strict,omitempty"`
	UseIdentifierInUrls *value.Value[bool] `json:"use-identifier-in-urls,omitempty"`
}

// SamlIntegrationRelationshipsRequest holds the relationships for SamlIntegration (request)
type SamlIntegrationRelationshipsRequest struct {
}
